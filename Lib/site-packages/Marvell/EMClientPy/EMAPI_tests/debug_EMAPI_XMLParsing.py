# from __future__ import print_function
# import codecs
import os
import sys
from os import path
from inspect import getfile, currentframe

sys.path.append( path.dirname( path.dirname( path.abspath(__file__) ) ) )

from Marvell.EMClientPy.src.EMClientFactory import *

dir = os.path.dirname(os.path.abspath(getfile(currentframe())))  # script directory
from Marvell.EMClientPy.src.Common.Types import BoardPowerModeEnum

def printResults(em):
    A2Ds = em.GetA2Ds()
    print("A2Ds:")
    print(A2Ds)
    for a2dId in A2Ds:
        print("A2D <%s>  Channels:" % a2dId)
        print(em.GetA2DChannels(a2dId))

    Smms = em.GetSMMs()
    print("SMMs:")
    print(Smms)
    for smmId in Smms:
        print("Smm <%s>  Channels:" % smmId)
        print(em.GetSMMChannels(smmId))

    PSs = em.GetPSs()
    print("PSs:")
    print(PSs)
    #em.StoreVddAsDefaultToNVM(0x59)
    print("PS info:")
    for ps in PSs:
        currPs = em.PsInfoGet(ps)
        print(currPs)
        pass


def main_EMAPI_XMLParsing():
    em = EMClientFactory.getEM_Instance()

    em.ConfigUnload()
    em.ConfigLoad(dir + '\..\\resources\em_xml_test_AC5.xml')
    # printResults(em)[0:4]

    # em.configUnload()
    # content = codecs.open(dir + '\..\\resources\em_xml_test_parsing.xml', "r", encoding='utf-8').read()
    # em.configContentLoad(content)
    printResults(em)



if __name__ == "__main__":
    main_EMAPI_XMLParsing()

