# from __future__ import print_function
# from __future__ import absolute_import
from Marvell.EMClientPy.EMAPI_tests.test_EMAPI_onBoard import *
from Marvell.EMClientPy.EMAPI_tests.debug_EMAPI_XMLParsing import *
import os

from inspect import getfile, currentframe

XML_FILE = "C:\\TMP\\test_vdd.xml"
SUB20 = 0x72BE
DUT = False
Debug_Mode = True

dir = os.path.dirname(os.path.abspath(getfile(currentframe())))  # script directory

def Debug():
    try:
        em = EMClientFactory.getEM_Instance() #EMClientFactory.getEM_CPPInstance()
        #em.configLoad(dir + '\..\\resources\\Falcon-6_4T_EM_SMM_wPMbus_Rev_1_0_0_converted2.xml')
        em.ConfigLoad(XML_FILE)

        em.SetI2cInterface(1)

        #em.SetI2cSettings(SUB20, 30, 1, 10, None, 0)
        #em.SetI2cSettings(SUB20)

        #em.SetVdd_PMBusValue(3, 5000)
        v = em.GetVdd_PMBusValue(3)

        #em.SetVdd_PMBusValue(0,1200)

    except Exception as err:
        print(str(err))




def main():
    if Debug_Mode:
        Debug()
    else:
        main_EMAPI_XMLParsing()
        if DUT:
            main_EMAPI_onBoard()

if __name__ == "__main__":
    main()






